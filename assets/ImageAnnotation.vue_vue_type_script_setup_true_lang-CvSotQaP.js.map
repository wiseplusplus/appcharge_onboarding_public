{"version":3,"file":"ImageAnnotation.vue_vue_type_script_setup_true_lang-CvSotQaP.js","sources":["../../node_modules/.pnpm/lucide-vue-next@0.511.0_vue@3.5.27_typescript@5.3.3_/node_modules/lucide-vue-next/dist/esm/icons/x.js","../../src/components/ImageAnnotation.vue"],"sourcesContent":["/**\n * @license lucide-vue-next v0.511.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst X = createLucideIcon(\"x\", [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n]);\n\nexport { X as default };\n//# sourceMappingURL=x.js.map\n","<script setup lang=\"ts\">\nimport { ref, onMounted, onUnmounted, nextTick } from 'vue'\nimport { Info, X } from 'lucide-vue-next'\nimport type { Annotation } from '@/types'\n\nconst props = defineProps<{\n  src: string\n  alt?: string\n  annotations: Annotation[]\n}>()\n\nconst activeAnnotation = ref<Annotation | null>(null)\nconst imageRef = ref<HTMLImageElement | null>(null)\nconst containerRef = ref<HTMLElement | null>(null)\nconst imageRect = ref({ width: 0, height: 0, left: 0, top: 0 })\n\nconst updateImageRect = () => {\n  if (imageRef.value && containerRef.value) {\n    const img = imageRef.value\n    const container = containerRef.value\n    \n    // Calculate the actual displayed size of the image within object-contain\n    const imgRatio = img.naturalWidth / img.naturalHeight\n    const containerRatio = container.clientWidth / container.clientHeight\n    \n    let displayedWidth, displayedHeight, left, top\n\n    if (containerRatio > imgRatio) {\n      // Image is height-constrained\n      displayedHeight = container.clientHeight\n      displayedWidth = displayedHeight * imgRatio\n      left = (container.clientWidth - displayedWidth) / 2\n      top = 0\n    } else {\n      // Image is width-constrained\n      displayedWidth = container.clientWidth\n      displayedHeight = displayedWidth / imgRatio\n      left = 0\n      top = (container.clientHeight - displayedHeight) / 2\n    }\n\n    imageRect.value = {\n      width: displayedWidth,\n      height: displayedHeight,\n      left,\n      top\n    }\n  }\n}\n\nconst handleMouseEnter = (annotation: Annotation) => {\n  activeAnnotation.value = annotation\n  // Start animation loop to sync rects during transition\n  const startTime = performance.now()\n  const duration = 350 // Slightly longer than CSS transition (300ms)\n  \n  const animate = (currentTime: number) => {\n    updateImageRect()\n    if (currentTime - startTime < duration) {\n      requestAnimationFrame(animate)\n    }\n  }\n  requestAnimationFrame(animate)\n}\n\n// Watch for window resize\nonMounted(() => {\n  window.addEventListener('resize', updateImageRect)\n  // Initial calculation when image loads\n  if (imageRef.value?.complete) {\n    updateImageRect()\n  } else {\n    imageRef.value?.addEventListener('load', updateImageRect)\n  }\n  \n  // Use ResizeObserver for more robust size tracking of the container\n  const observer = new ResizeObserver(() => {\n    updateImageRect()\n  })\n  if (containerRef.value) {\n    observer.observe(containerRef.value)\n  }\n})\n\nonUnmounted(() => {\n  window.removeEventListener('resize', updateImageRect)\n})\n\nconst closePopup = () => {\n  activeAnnotation.value = null\n  // Start animation loop to sync rects during transition\n  const startTime = performance.now()\n  const duration = 350 // Slightly longer than CSS transition (300ms)\n  \n  const animate = (currentTime: number) => {\n    updateImageRect()\n    if (currentTime - startTime < duration) {\n      requestAnimationFrame(animate)\n    }\n  }\n  requestAnimationFrame(animate)\n}\n</script>\n\n<template>\n  <div class=\"relative w-full h-full flex flex-col md:flex-row gap-4 transition-all duration-300\">\n    <!-- Image Container -->\n    <div \n      ref=\"containerRef\"\n      class=\"relative bg-slate-100 rounded-xl overflow-hidden border border-slate-200 shadow-sm group h-full transition-all duration-300 ease-in-out\"\n      :class=\"activeAnnotation ? 'flex-[2]' : 'flex-1'\"\n    >\n      <div class=\"relative w-full h-full\">\n        <img \n          ref=\"imageRef\"\n          :src=\"src\" \n          :alt=\"alt || 'Annotation Image'\"\n          class=\"w-full h-full object-contain\"\n          @load=\"updateImageRect\"\n        />\n        \n        <!-- Hotspots Overlay Layer - Positioned absolutely over the ACTUAL image content -->\n        <div \n          class=\"absolute pointer-events-none transition-all duration-300 ease-in-out\"\n          :style=\"{\n            width: `${imageRect.width}px`,\n            height: `${imageRect.height}px`,\n            left: `${imageRect.left}px`,\n            top: `${imageRect.top}px`\n          }\"\n        >\n          <!-- Actual Hotspots - Pointer events re-enabled -->\n          <div \n            v-for=\"ann in annotations\"\n            :key=\"ann.id\"\n            class=\"absolute border-2 border-dashed border-blue-400 bg-blue-500/10 hover:bg-blue-500/20 cursor-help transition-all duration-200 rounded-md pointer-events-auto\"\n            :class=\"{ 'border-solid border-green-500 bg-green-500/20': activeAnnotation?.id === ann.id }\"\n            :style=\"{\n              left: `${ann.x}%`,\n              top: `${ann.y}%`,\n              width: `${ann.width}%`,\n              height: `${ann.height}%`\n            }\"\n            @mouseenter=\"handleMouseEnter(ann)\"\n          >\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Description Sidebar (Popup) -->\n    <!-- Use relative flex sizing to push the image -->\n    <div \n      class=\"relative shrink-0 flex flex-col justify-center transition-all duration-300 ease-in-out\"\n      :class=\"activeAnnotation ? 'w-80 opacity-100 translate-x-0' : 'w-0 opacity-0 translate-x-4'\"\n    >\n       <div \n          v-if=\"activeAnnotation\"\n          class=\"w-80 h-auto max-h-full bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden flex flex-col pointer-events-auto z-10\"\n        >\n          <div class=\"p-4 bg-slate-50 border-b border-slate-100 flex justify-between items-start shrink-0\">\n            <h3 class=\"font-bold text-lg text-slate-800\">{{ activeAnnotation.content.title }}</h3>\n            <button @click=\"closePopup\" class=\"text-slate-400 hover:text-slate-600\">\n              <X class=\"w-5 h-5\" />\n            </button>\n          </div>\n          \n          <div class=\"p-5 space-y-6 overflow-y-auto flex-1\">\n            <!-- Concept -->\n            <div>\n              <h4 class=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2\">Concept</h4>\n              <p class=\"text-sm text-slate-600 leading-relaxed\">\n                {{ activeAnnotation.content.concept }}\n              </p>\n            </div>\n\n            <!-- Usage -->\n            <div>\n              <h4 class=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2\">Usage</h4>\n              <p class=\"text-sm text-slate-600 leading-relaxed\">\n                {{ activeAnnotation.content.usage }}\n              </p>\n            </div>\n\n            <!-- Keywords -->\n            <div v-if=\"activeAnnotation.content.keywords.length\">\n              <h4 class=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2\">Keywords</h4>\n              <div class=\"flex flex-wrap gap-2\">\n                <span \n                  v-for=\"kw in activeAnnotation.content.keywords\" \n                  :key=\"kw\"\n                  class=\"px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded-md font-medium\"\n                >\n                  {{ kw }}\n                </span>\n              </div>\n            </div>\n\n            <!-- Reference -->\n            <div v-if=\"activeAnnotation.content.reference\">\n              <h4 class=\"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2\">Resources</h4>\n              <a \n                :href=\"activeAnnotation.content.reference\" \n                target=\"_blank\"\n                class=\"text-sm text-blue-600 hover:underline flex items-center gap-1\"\n              >\n                Learn more\n              </a>\n            </div>\n          </div>\n        </div>\n    </div>\n  </div>\n</template>\n"],"names":["X","createLucideIcon","activeAnnotation","ref","imageRef","containerRef","imageRect","updateImageRect","img","container","imgRatio","containerRatio","displayedWidth","displayedHeight","left","top","handleMouseEnter","annotation","startTime","duration","animate","currentTime","onMounted","_a","_b","observer","onUnmounted","closePopup","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_normalizeClass","_hoisted_2","__props","_normalizeStyle","_Fragment","_renderList","ann","$event","_hoisted_5","_hoisted_6","_hoisted_7","_toDisplayString","_createVNode","_unref","_hoisted_8","_cache","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","kw","_hoisted_13","_hoisted_14"],"mappings":"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","x_google_ignoreList":[0]}